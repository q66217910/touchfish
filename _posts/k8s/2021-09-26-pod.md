---
layout: post
title: Pod介绍
category: k8s
tags: [k8s]
no-post-nav: true
---

## K8S-Pod

pod 是 Kubernetes 项目中最小的 API 对象。  是 Kubernetes 项目的原子调度单位 。



###  1.为什么我们会需要 Pod 

 <font color=#FF0000>容器的本质是进程</font> ，在操作系统中进程往往不会单独运行，而是以进程组的方式组织在一起。在操作系统的层面上，进程组更便于管理。将进程组的概念映射到容器技术中，便是Pod了。

若容器间存在紧密协作（互相间文件交换，使用localhost/socket文件本地通信，频繁的远程调用，需要共享linux的namespace），部署为同一个Pod会更加有利于调度。





###  2.Pod的实现原理 

1. **pod本身只是一个逻辑概念：**

    Kubernetes中真正处理的还是宿主机 操作系统上 Linux 容器的 Namespace 和 Cgroups 。Pod其本质就是一组共享了资源的容器。Pod里所有的容器，共享的同一个Network Namespace

2.  **Infra 容器 ：**

   在pod中,  Infra 容器 永远是第一个创建的，其实用户定义的容器，则通过 Join Network Namespace 的方式，与 Infra 容器关联在一起。  Infra 容器一定要占用极少的资源，所以它使用的是一个非常特殊的镜像，叫作：`k8s.gcr.io/pause`。这个镜像是一个用汇编语言编写的、永远处于“暂停”状态的容器，解压后的大小也只有 100~200 KB 左右。 

   通过infra容器，pod中的容器可以做到

   -  直接使用 localhost 进行通信 
   -  它们看到的网络设备跟 Infra 容器看到的完全一样 
   -  一个 Pod 只有一个 IP 地址，也就是这个 Pod 的 Network Namespace 对应的 IP 地址 
   -  其他的所有网络资源，都是一个 Pod 一份，并且被该 Pod 中的所有容器共享 
   -  Pod 的生命周期只跟 Infra 容器一致 
   -  Pod 里面的所有用户容器来说，它们的进出流量，也可以认为都是通过 Infra 容器完成的 
