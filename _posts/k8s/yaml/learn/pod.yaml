apiVersion: v1
kind: Pod
#元数据
metadata:
  #pod的名称
  name: zd
  #namespace
  namespace: zd
  #标签列表(Label其实就一对 key/value),Labels的值对系统本身并没有什么含义，
  #只是对用户才有意义。同一个资源对象的labels属性的key必须唯一.
  #label可以附加到各种资源对象上，如Node,Pod,Service,RC等。一个资源拥有多个标签，可以实现不同维度的管理
  labels:
    #label 必须以字母或数字开头，可以使用字母、数字、连字符、点和下划线，最长63个字符
    #kubectl get pods --show-labels(查看pod显示labels)
    - environment: dev
    - release: stable
    - app: zd
  #自定义注解列表(客户端程序可以获取这些元数据)
  annotations:
    - imageregistry: "https://hub.docker.com/"
spec:
  #挂载数据卷
  #
  volumes:
    - name: zd
      emptyDir: {}
    - name: zd-1
      #投射数据卷(Secret/ConfigMap/Downward API/ServiceAccountToken)
      projected:
        sources:
          #Secret:加密数据，存放到 Etcd 中
          #ConfigMap: 应用配置
          #Downward API:让 Pod 里的容器能够直接获取到这个 Pod API 对象本身的信息。
          #ServiceAccountToken:授权信息
          - secret:
              name: zd-secret
  securityContext:
    runAsUser: 1001   
  #镜像列表
  containers:
    - name: tomcat
      #镜像名称
      image: redis:latest
      #镜像拉取策略 （Always：每次拉取最新镜像，在:latest时默认Always）
      #IfNotPresent: 已经存在的情况下直接略过拉取镜像的操作
      #Never: 只使用本地镜像，从不拉取
      imagePullPolicy: Always
      #安全上下文（Security Context）定义 Pod 或 Container 的特权与访问控制设置
      #自主访问控制:基于 用户 ID（UID）和组 ID（GID）
      securityContext:
        runAsNonRoot: false
        runAsUser: 1001
      #使用数据卷
      volumeMounts:
          #容器内安装数据卷的位置
        - mountPath: /home
          #数据卷的名称
          name: zd-volume
      #容器要使用的块设备列表
      volumeDevices:
          #是设备将映射到的容器内的路径
        - devicePath: /app
          name: zd-volume
      #容器中设置的环境变量
      env:
        - name: name
          value: value
      #ConfigMap定义的配置可以通过envFrom传入给容器
      envFrom:
        - configMapRef:
            name: zd-mysql-nacos
          #秘钥配置
          secretRef:
            name: zd-secret
      #探针
      #livenessProbe:指示容器是否正在运行。如果存活态探测失败，则 kubelet 会杀死容器， 并且容器将根据其重启策略决定未来
      #readinessProbe:指示容器是否准备好为请求提供服务。
      #startupProbe: 指示容器中的应用是否已经启动。
  #容器的重启策略
  #Always: 如果容器停止，总是重新启动容器。
  #OnFailure: 容器终止运行且退出码不为0时重启
  #Never : 不论状态为何， kubelet 都不重启该容器
  restartPolicy: Always 
        
      

#mysql配置
---
apiVersion: v1
kind: ConfigMap
metadata:
  namespace: zd
  name: zd-mysql-nacos
data:
  mysql.host: "www.uetty.com"
  mysql.port: "8806"
  mysql.name: "nacos"
  mysql.user: "uetty"
  mysql.password: "35#B!!)"
  
---
apiVersion: v1
kind: Secret
metadata:
  namespace: zd
  name: zd-secret
  
